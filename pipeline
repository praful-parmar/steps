pipeline{
    agent any

    environment {
        secret = credentials('dockerhub')
    }

    stages{
        stage('build'){
            steps{
               sh './scripts/mvn mvn -B -DskipTests clean package'
               sh './scripts/build'
            }
        }
        stage('test'){
            steps{
               sh './scripts/mvn mvn test'
            }
        }
        stage('push'){
            steps{
                sh './scripts/push_img $secret'
            }
        }
        stage('deploy'){
            steps{
               sh './scripts/transfer_to_remote $secret'
            }
        }
    }
}
